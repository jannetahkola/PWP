server:
  error:
    whitelabel:
      enabled: false
  servlet:
    context-path: /users-api
  port: 8080

spring:
  # setting this to false will produce correct Swagger for JSON with HATEOAS (no HAL)
  # users API uses HAL so here for reference
  # see https://github.com/springdoc/springdoc-openapi/issues/401
  hateoas:
    use-hal-as-default-json-media-type: true
  datasource:
    url: jdbc:h2:mem:palikka_users_db;TIME ZONE=UTC
  sql:
    init:
      # specify a different file than the default 'data.sql' to prevent seeding during tests
      data-locations:
        - classpath:seed_privileges.sql
        - classpath:seed_roles.sql
        - classpath:seed.sql
  jpa:
    # let hibernate create the schema before seed data is inserted
    # see https://www.baeldung.com/spring-boot-h2-database#2-hibernate-and-datasql
    defer-datasource-initialization: true
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        jdbc:
          # not applied with H2, URL def is used instead. Here for reference
          # see http://www.h2database.com/html/commands.html#set_time_zone
          time_zone: UTC
        format_sql: true
        show_sql: true

palikka:
  jwt:
    keystore:
      signing:
        path: file:keystore-dev.p12
        pass: password
        type: pkcs12
      verification:
        path: file:truststore-dev.p12
        pass: password
        type: pkcs12
    token:
      user:
        issuer: palikka-dev-usr
        signing:
          key-alias: jwt-usr
          key-pass: password
          validity-time: 1h
      system:
        issuer: palikka-dev-sys
        signing:
          key-alias: jwt-sys
          key-pass: password
          validity-time: 10s